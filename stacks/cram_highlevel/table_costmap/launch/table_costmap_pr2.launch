
<launch>
  <include file="$(find pr2_machine)/$(optenv ROBOT pr2).machine"/>

  <group ns="/laser_table_detector">
    <node pkg="laser_assembler" type="point_cloud_assembler" name="table_costmap_tilting_assembler"
          machine="c2">
      <remap from="cloud" to="/tilt_scan_filtered"/>
      <param name="max_clouds" value="600"/>
      <param name="fixed_frame" value="/map"/>
    </node>

    <node pkg="pr2_laser_snapshotter" type="pr2_laser_snapshotter" name="tilt_snapshotter"
          machine="c2">
      <remap from="laser_scanner_signal" to="/laser_tilt_controller/laser_scanner_signal"/>
      <remap from="full_cloud" to="assembled_cloud"/>
    </node>
    
    <node pkg="point_cloud_converter" type="point_cloud_converter" name="convert_cloud" machine="c2">
      <remap from="/points_in" to="assembled_cloud" />
      <remap from="/points2_out" to="assembled_cloud2" />
    </node>
  </group>
  
  <include file="$(find table_costmap)/launch/laser_table_detector_pr2.launch"/>
  
  <node name="table_costmap" pkg="table_costmap" type="table_costmap" machine="c2">
    <remap from="~input" to="/laser_table_detector/table_polygon/output"/>
    <param name="resolution" value="0.05"/>
  </node>
</launch>
